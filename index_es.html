<!DOCTYPE html>
<html lang="es-ES">

<head>
<script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.4.4/d3.min.js"></script>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css" integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk"
    crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css">
<title>Indicadors LET</title>
<script lang="javascript" src="https://cdn.sheetjs.com/xlsx-latest/package/dist/xlsx.full.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js@3.7.1/dist/chart.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.0.0"></script>
<script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/gh/xcash/bootstrap-autocomplete@master/dist/latest/bootstrap-autocomplete.min.js"></script>
<script src="https://lablet.uab.cat/visorlet/js/iframe-adaptation-iframe.js"></script>
<script>



function calcula(valor){
    filtre_elec = electricitat.filter(element => element.nommuni == valor);
    filtre_gas = gas.filter(element => element.nommuni == valor);
    filtre_aigua = aigua.filter(element => element.nommuni == valor);
    filtre_residus = residus.filter(element => element.nommuni == valor);
    filtre_no2 = no2.filter(element => element.nommuni == valor);
    filtre_pm10 = pm10.filter(element => element.nommuni == valor);
    filtre_ice = ice.filter(element => element.nommuni == valor);
    filtre_incendis = incendis.filter(element => element.nommuni == valor);
    filtre_temp = temp.filter(element => element.nommuni == valor);
    filtre_ppt = ppt.filter(element => element.nommuni == valor);
    filtre_estat_12 = estat_rius.filter(element => element.nommuni == valor);
    filtre_estat_18 = estat_rius.filter(element => element.nommuni_1 == valor);
    filtre_cobertes = cobertes.filter(element => element.field_1 == valor);
    filtre_pob = poblacio.filter(element => element.categoria == valor);
    filtre_densitat = densitat.filter(element => element.categoria == valor);
    filtre_atur = atur.filter(element => element.nommuni== valor);
    filtre_prod = prod.filter(element => element.municipi== valor);
    filtre_renda = renda.filter(element => element.nommuni == valor);
    filtre_gini = gini.filter(element => element.nommuni == valor);
    filtre_immigra = immigra.filter(element => element["municipi %"] == valor);
    filtre_ist = ist.filter(element => element.municipi == valor);
    filtre_hab = hab.filter(element => element.nommuni == valor);
    filtre_estudis = estudis.filter(element => element.nommuni == valor);
    filtre_patents = patents.filter(element => element.nommuni == valor);
    filtre_gasos = gasos.filter(element => element.nommuni == valor);
    myChart1.destroy();
    pintar1();
    myChart2.destroy();
    pintar2();
    myChart3.destroy();
    pintar3();
    myChart4.destroy();
    pintar4();
    myChart5.destroy();
    pintar5();
    myChart6.destroy();
    pintar6();
    myChart7.destroy();
    pintar7();
    myChart8.destroy();
    pintar8();
    myChart9.destroy();
    pintar9();
    myChart10.destroy();
    pintar10();
    myChart11.destroy();
    pintar11();
    myChart12.destroy();
    pintar12();
    myChart13.destroy();
    pintar13();
    myChart14.destroy();
    pintar14();
    myChart15.destroy();
    pintar15();
    myChart16.destroy();
    pintar16();
    myChart17.destroy();
    pintar17();
    myChart18.destroy();
    pintar18();
    myChart19.destroy();
    pintar19();
    myChart20.destroy();
    pintar20();
}

function canvi(ambit){
        switch (ambit){
            case "B30": 
                var listItems = '<option selected="selected" value="B30">Total ámbito ('+munisB30.length +' municipios) </option>';
                    for (var i = 0; i < munisB30.length; i++) {
                        listItems += '<option value="' + munisB30[i].B30+ '">' + munisB30[i].B30+ '</option>';
                    }
                break;
            case "AMB":
                var listItems = '<option selected="selected" value="AMB">Total ámbito ('+munisAMB.length +' municipios) </option>';
                for (var i = 0; i < munisAMB.length; i++) {
                    listItems += '<option value="' + munisAMB[i].AMB + '">' + munisAMB[i].AMB+ '</option>';
                }
                break;
            case "RMB":
                var listItems = '<option selected="selected" value="RMB">Total ámbito ('+munisRMB.length +' municipios) </option>';
                for (var i = 0; i < munisRMB.length; i++) {
                    listItems += '<option value="' + munisRMB[i].RMB + '">' + munisRMB[i].RMB+ '</option>';
                }
                break;
        }
        calcula(ambit);

        $("#municipis").html(listItems);
}
</script>
<style>
    .boto{
        display:none;
        float:right;
        position:relative;
        top: 10px;
        height:10px;
        border: none;
        outline: none !important;
        background-color: transparent;
    }
    .fa-circle-info {
        color: gray;
        }

</style>
</head>
<body>
    <div class="container" style="font-family: Arial, Helvetica, sans-serif;font-weight: bold;" >
        <div class="row" style="height:30px"></div>
        <div class="row ">
            <div class="col-1 "></div>
            <div class="col-md-auto border d-flex align-items-center" style="background-color:rgba(244,175,133,255)">Escoge ámbito territorial:</div>
            <div class="col-md-auto border d-flex align-items-center" style="background-color:rgba(255,242,205,255);font-size: 12px;">
                <select class="form-control basicAutoSelect" style="font-size:12px;font-weight:bold;" name="area" onchange="canvi(this.value)">
                    <option value="AMB">Area Metropolitana de Barcelona</option>
                    <option value="B30">B-30</option>
                    <option value="RMB">Regió Metropolitana de Barcelona</option>
                </select>
            </div>
            <div class="col-1"></div>
            <div class="col-2 border d-flex align-items-center" style="background-color:rgba(244,175,133,255)">Filtro por municipio:</div>
            <div class="col-md-auto border d-flex align-items-center" style="background-color:rgba(255,242,205,255);font-size: 12px ;">
                <select class="form-control basicAutoSelect" style="font-size:12px;font-weight:bold;" name="municipi" id="municipis" onchange="calcula(this.value)" >
                   
                </select>
            </div>
        </div>
    </div>
    <div class="container-fluid" style="width: 98%;" >
        <div class="row">
            <div class="col-md-auto border" style="background-color: rgba(164,208,139,255);font-family: Arial, Helvetica, sans-serif;font-weight: bold;">Indicadores Socioecológicos</div>
        </div>
    </div>
    <div class="container-fluid border" style="width: 98%;background-color: rgba(225,239,216,255);">
        <div class="row" style="height: 10px;"></div>
        <div class="row">
            <div class="col-md border border-dark">
                <button type="button" id="1" class="boto"  onclick="omple('1');" data-toggle="modal" data-target="#exampleModal"> <b><i class="fa-solid fa-circle-info"></i></b></button>
                <canvas id="myChart1" style="width:300px;height:300px;"></canvas>
               
            </div>
            <div class="col-md border border-dark">
                <button type="button" id="2" class="boto"  onclick="omple('2');" data-toggle="modal" data-target="#exampleModal"> <b><i class="fa-solid fa-circle-info" ></i></b></button>
                <canvas id="myChart2" style="width:300px;height:300px;"></canvas>
        
            </div>
            <div class="col-md border  border-dark">
                <button type="button" id="3" class="boto"  onclick="omple('3');" data-toggle="modal" data-target="#exampleModal"> <b><i class="fa-solid fa-circle-info"></i></b></button>
                <canvas id="myChart3" style="width:300px;height:300px;"></canvas>
               
            </div>
            <div class="col-md border border-dark">
                <button type="button" id="4" class="boto"  onclick="omple('4');" data-toggle="modal" data-target="#exampleModal"> <b><i class="fa-solid fa-circle-info"></i></b></button>
                <canvas id="myChart4" style="width:300px;height:300px;"></canvas>
            </div>
            <div class="col-md border border-dark">
                <button type="button" id="5" class="boto"  onclick="omple('5');" data-toggle="modal" data-target="#exampleModal"> <b><i class="fa-solid fa-circle-info"></i></b></button>
                <canvas id="myChart5" style="width:300px;height:300px;"></canvas>
            </div>
        </div>
        <div class="row">
            <div class="col-md border border-dark">
                <button type="button" id="6" class="boto"  onclick="omple('6');" data-toggle="modal" data-target="#exampleModal"> <b><i class="fa-solid fa-circle-info"></i></b></button>
                <canvas id="myChart6" style="width:300px;height:300px;"></canvas>
            </div>
            <div class="col-md border border-dark">
                <button type="button" id="7" class="boto"  onclick="omple('7');" data-toggle="modal" data-target="#exampleModal"> <b><i class="fa-solid fa-circle-info"></i></b></button>
                <canvas id="myChart7" style="width:300px;height:300px;"></canvas>
            </div>
            <div class="col-md border border-dark">
                <button type="button" id="8" class="boto"  onclick="omple('8');" data-toggle="modal" data-target="#exampleModal"> <b><i class="fa-solid fa-circle-info"></i></b></button>
                <canvas id="myChart8" style="width:300px;height:300px;"></canvas>
            </div>
            <div class="col-md border border-dark">
                <button type="button" id="9" class="boto"  onclick="omple('9');" data-toggle="modal" data-target="#exampleModal"> <b><i class="fa-solid fa-circle-info"></i></b></button>
                <canvas id="myChart9" style="width:300px;height:300px;"></canvas>
            </div>
            <div class="col-md border border-dark">
                <button type="button" id="10" class="boto"  onclick="omple('10');" data-toggle="modal" data-target="#exampleModal"> <b><i class="fa-solid fa-circle-info"></i></b></button>
                <canvas id="myChart10" style="width:300px;height:300px;"></canvas>
            </div>
        </div>
</div>

<div class="row" style="height: 30px;"></div>
<div class="container-fluid" style="width: 98%;" >
    <div class="row">
        <div class="col-md-auto border" style="background-color: rgba(164,208,139,255);font-family: Arial, Helvetica, sans-serif;font-weight: bold;">Indicadores Socioeconómicos</div>
    </div>
</div>
<div class="container-fluid border" style="width: 98%;background-color: rgba(225,239,216,255);">
    <div class="row" style="height: 10px;"></div>
    <div class="row">
        <div class="col-md border border-dark">
            <button type="button" id="11" class="boto"  onclick="omple('11');" data-toggle="modal" data-target="#exampleModal"> <b><i class="fa-solid fa-circle-info"></i></b></button>
            <canvas id="myChart11" style="width:300px;height:300px;"></canvas>
        </div>
        <div class="col-md border border-dark">
            <button type="button" id="12" class="boto"  onclick="omple('12');" data-toggle="modal" data-target="#exampleModal"> <b><i class="fa-solid fa-circle-info"></i></b></button>
            <canvas id="myChart12" style="width:300px;height:300px;"></canvas>
        </div>
        <div class="col-md border  border-dark">
            <button type="button" id="13" class="boto"  onclick="omple('13');" data-toggle="modal" data-target="#exampleModal"> <b><i class="fa-solid fa-circle-info"></i></b></button>
            <canvas id="myChart13" style="width:300px;height:300px;"></canvas>
        </div>
        <div class="col-md border border-dark">
            <button type="button" id="14" class="boto"  onclick="omple('14');" data-toggle="modal" data-target="#exampleModal"> <b><i class="fa-solid fa-circle-info"></i></b></button>
            <canvas id="myChart14" style="width:300px;height:300px;"></canvas>
        </div>
        <div class="col-md border border-dark">
            <button type="button" id="15" class="boto"  onclick="omple('15');" data-toggle="modal" data-target="#exampleModal"> <b><i class="fa-solid fa-circle-info"></i></b></button>
            <canvas id="myChart15" style="width:300px;height:300px;"></canvas>
        </div>
    </div>
    <div class="row">
        <div class="col-md border border-dark">
            <button type="button" id="16" class="boto"  onclick="omple('16');" data-toggle="modal" data-target="#exampleModal"> <b><i class="fa-solid fa-circle-info"></i></b></button>
            <canvas id="myChart16" style="width:300px;height:300px;"></canvas>
        </div>
        <div class="col-md border border-dark">
            <button type="button" id="17" class="boto"  onclick="omple('17');" data-toggle="modal" data-target="#exampleModal"> <b><i class="fa-solid fa-circle-info"></i></b></button>
            <canvas id="myChart17" style="width:300px;height:300px;"></canvas>
        </div>
        <div class="col-md border border-dark">
            <button type="button" id="18" class="boto"  onclick="omple('18');" data-toggle="modal" data-target="#exampleModal"> <b><i class="fa-solid fa-circle-info"></i></b></button>
            <canvas id="myChart18" style="width:300px;height:300px;"></canvas>
        </div>
        <div class="col-md border border-dark">
            <button type="button" id="19" class="boto"  onclick="omple('19');" data-toggle="modal" data-target="#exampleModal"> <b><i class="fa-solid fa-circle-info"></i></b></button>
            <canvas id="myChart19" style="width:300px;height:300px;"></canvas>
        </div>
        <div class="col-md border border-dark">
            <button type="button" id="20" class="boto"  onclick="omple('20');" data-toggle="modal" data-target="#exampleModal"> <b><i class="fa-solid fa-circle-info"></i></b></button>
            <canvas id="myChart20" style="width:300px;height:300px;"></canvas>
        </div>
    </div>
</div>
<!-- Button trigger modal -->


<!-- Modal -->
<div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
<div class="modal-dialog" role="document">
  <div class="modal-content">
    <div class="modal-header">
      <h6 class="modal-title" id="titol">Info</h5>
      <button type="button" class="close" data-dismiss="modal" aria-label="Close">
        <span aria-hidden="true">&times;</span>
      </button>
    </div>
    <div id="contingut" class="modal-body" style="color: gray;">
        ...
    </div>
  </div>
</div>
</div>
</body>
<script>
Chart.register(ChartDataLabels);
Chart.defaults.set('plugins.datalabels', {
    color: '#FFFFFF',
    display:false
    });
Chart.defaults.set('plugins.title', {
    font: {
      size: 14
    }
});



function omple(div){
    switch (div){
        case "1":  titol='Variabilidad climática ';
                    texte= "% de variación de la precipitación respecto a la media, ºC de variación respecto a la temperatura media.";
                    temporalitat='2017-2021';
                    font='Servei Meteorològic de Catalunya.';
                    break;
        case "2":  titol='Usos del suelo';
                    texte= "Usos del ssuelo (% de superficie)";
                    temporalitat='1987, 1992, 1997, 2002, 2007, 2012,2017';
                    font='CREAF';
                    break;
        case "3":  titol='Incendios forestales';
                    texte= "Totales de superfície quemada en ha.";
                    temporalitat='1986-2021';
                    font='GENCAT';
                    break;
        case "4":  titol='Funcionalidad del paisaje ';
                    texte= "Índice de conectividad ecológica de los espacios abiertos ";
                    temporalitat='1956, 1993, 2009, 2015 ';
                    font='IERMB';
                    break;
        case "5":  titol="Calidad del agua";
                    texte= "Estado ecológico de los ríos, indicador que combina la calidad biológica, fisicoquímica e hidromorfológica";
                    temporalitat='2007-2012, 2013-2018  ';
                    font="Agencia Catalana de l'Aigua (ACA)";
                    break;
        case "6":  titol="Consumo de energía";
                    texte= "Consumo de energía eléctrica y de gas natural en el ámbito doméstico. Datos en KWh.";
                    temporalitat='2013-2020 ';
                    font='IDESCAT';
                    break;
        case "7":  titol="Consumo de agua";
                    texte= "Consumo doméstico de agua por habitante. Datos en m3 por año.";
                    temporalitat='2013-2020 ';
                    font='IDESCAT';
                    break;
        case "8":  titol="Generación de residuos";
                    texte= "Generación de residuos domésticos por habitante. Datos en kg per cápita por año.";
                    temporalitat='2015-2020 ';
                    font='IDESCAT';
                    break;
        
        case "9":  titol="Contaminación atmosférica";
                    texte= "Concentración de contaminantes por los puntos de la Red de Vigilancia y Previsión de la Contaminación Atmosférica";
                    temporalitat='2015-2021';
                    font='Departament de Medi Ambient i Sostenibilitat.';
                    break;
        case "10":  titol="Gases de efecto invernadero";
                    texte= "Emisiones GEI(tCO2) per cápita por municipio";
                    temporalitat='2005-2017  ';
                    font='Diputació de Barcelona ';
                    break;
        case "11":  titol="Población ";
                    texte= "Población.Habitantes y densidad de población por km2";
                    temporalitat='2000-2020 ';
                    font='IDESCAT ';
                    break;  
        case "12":  titol="Nivel de renta";
                    texte= "Renta familiar disponible bruta territorial por habitante";
                    temporalitat='2010-2019 ';
                    font='IDESCAT i INE ';
                    break;         
        case "13":  titol="Productividad ";
                    texte= "PIB territorial per cápita por municipio";
                    temporalitat='2011-2019 ';
                    font='IDESCAT ';
                    break;
        case "14":  titol="Paro";
                    texte= "Número de personas desempleadas en los municipios";
                    temporalitat='2005-2021 ';
                    font='SEPE';
                    break;
        case "15":  titol="Desigualdad";
                    texte= "Índice de desigualdad de Gini";
                    temporalitat='2015-2019 ';
                    font='INE';
                    break;
        case "16":  titol="Inmigración";
                    texte= "% de población extranjera respecto al total del municipio";
                    temporalitat='2000-2020 ';
                    font='IDESCAT ';
                    break;
        case "17":  titol="Nivel socioeconómico ";
                    texte= "Índice Socioeconómico Territorial respecto al total de Cataluña";
                    temporalitat='2015-2019 ';
                    font='IDESCAT ';
                    break;
        case "18":  titol="Vivienda ";
                    texte= "Demanda vivienda. Personas inscritas en el Registro de Solicitantes de viviendas de protección oficial";
                    temporalitat='2012-2020 ';
                    font="Secretaria d'Habitatge i Inclusió Social ";
                    break;
        case "19":  titol="Formación";
                    texte= "Población con bajos estudios. Porcentaje de población de 20 o más años que es analfabeta o tiene como mucho estudios de primaria. Corresponde a los niveles 0 y 1 de la clasificación CCED-2020 (A) ";
                    temporalitat='2015-2019 ';
                    font='IDESCAT ';
                    break;
        case "20":  titol="Innovación ";
                    texte= "Patentes totales registradas por municipio ";
                    temporalitat='2005-2015 ';
                    font='PATSTAT';
                    break;         
    }
    document.getElementById('titol').innerHTML='<b>'+titol+'</b>';
    document.getElementById('contingut').innerHTML='<b>Descripción: </b>'+texte + '<br><b>Temporalidad</b>: '+ temporalitat + '<br><b>Fuente</b>: ' + font;
}
</script>
<script src="idiomes.js"></script>
<script src="grafic1.js"></script>
<script src="grafic2.js"></script>
<script src="grafic3.js"></script>
<script src="grafic4.js"></script>
<script src="grafic5.js"></script>
<script src="grafic6.js"></script>
<script src="grafic7.js"></script>
<script src="grafic8.js"></script>
<script src="grafic9.js"></script>
<script src="grafic10.js"></script>
<script src="grafic11.js"></script>
<script src="grafic12.js"></script>
<script src="grafic13.js"></script>
<script src="grafic14.js"></script>
<script src="grafic15.js"></script>
<script src="grafic16.js"></script>
<script src="grafic17.js"></script>
<script src="grafic18.js"></script>
<script src="grafic19.js"></script>
<script src="grafic20.js"></script>

</body>
</html>
<script>
$(document).ready(function () {
    d3.csv('munis.csv').then(function(data){
        munis = data;
        munisAMB = munis.filter( element => element.AMB != "")
        munisB30 = munis.filter( element => element.B30 != "")
        munisRMB = munis.filter( element => element.RMB != "")
        var listItems = '<option selected="selected" value="AMB">Total ámbito(36 municipios)</option>';
        for (var i = 0; i < munisAMB.length; i++) {
                listItems += '<option value="' + munisAMB[i].AMB+ '">' + munisAMB[i].AMB+ '</option>';
            }

        $("#municipis").html(listItems);
        grafic1();
        grafic2();
        grafic3();
        grafic4();
        grafic5();
        grafic6();
        grafic7();
        grafic8();
        grafic9();
        grafic10();
        grafic11();
        grafic12();
        grafic13();
        grafic14();
        grafic15();
        grafic16();
        grafic17();
        grafic18();
        grafic19();
        grafic20();
    });
});
</script>